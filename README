lfview (Leaf 画像ローダ) Version 1.1beta
Author: TF(telnet@geocities.co.jp)
Date: 01/30/2000
Home page: http://www.imou.to/~tf/
======================================================================

What's this?
------------
Leaf のビジュアルノベル「雫」「痕」「To Heart」等に含まれる画像を表示
するビューアです．Unix 系 OS + X11 の環境で動作します．アーカイブ形式
から直接画像を読み出すことができるので，巨大なアーカイブを予め展開して
おく必要がないのが特徴です．

キャラクターの立ち絵は，X11 の shape extension を使って非矩形ウィンド
ウで表示することもできます．

動作確認
--------
Linux 2.0.x + XFree86 3.3.x
FreeBSD
OpenBSD
NEC EWS4800

対応フォーマット
----------------
 「雫」「痕」             LFG 形式画像
 「To Heart」             LF2 形式画像
 「さおりんといっしょ!!」 maxxdata.pak に含まれる LFG 形式画像
                          *.pak に含まれる *.grp 形式画像
 「初音のないしょ!」      vnhatdat.pak に含まれる LF2 形式画像
                          *.pak に含まれる *.grp 形式画像
 「White Album」          *.pak に含まれる *.grp, *.gad 形式画像
 「こみっくパーティー」   *.pak に含まれる *.grp 形式画像

 「White Album(オートデモ)」     *.pak に含まれる *.grp, *.gad 形式画像
 「こみっくパーティー(OP デモ)」 opening.pak に含まれる *.grp 形式画像

 「To Heart(Playstation 版)」 *.pak に含まれる画像
 「猪名川でいこう!!」     [一部対応]こみパクイズとおまけシナリオに含まれる *.grp, *.lf3 画像

アーカイブファイル形式(〜.pak)に対応しており，アーカイブを展開すること
なく画像を表示することができます．


インストール
------------
まず最初に config.tmpl を編集します．
(該当する OS についてコメントを外せば良いと思います．)

コンパイルは以下の手順で行います．

 xmkmf -a
 make
 make install

画像展開部分を共有ライブラリの形で分離しているので，X11 標準のディレク
トリにインストールしたくない場合には，予め config.tmpl の PLUGINDIR を
修正してください．make した後，実行ファイルは好きな場所に置いてかまい
ませんが，liblfv.so は PLUGINDIR で指定した場所に置いてください．


使用法
------
コマンド:
    lfview [-root] [-shape] [-geometry geom][-a アーカイブファイル] file1 file2 ...

-a オプションでアーカイブファイルを指定した時は，アーカイブ閲覧モード
で起動します．この時には file1, file2, ... はアーカイブ内の画像と解釈
されます．-a オプションの指定がない時は展開済みの画像ファイルを直接指
定したものと解釈します．

-root オプションが指定された場合には，画像をルートウィンドウに表示しま
す．この場合には，複数の画像が指定されていても，最初の引数で指定した画
像のみが表示されます．

-shape オプションはキャラクタの絵など透明部分を含む画像を，X11 の 
shape extenion を使って非矩形ウィンドウで表示するためのものです．とい
うのも， *.grp フォーマットには透明部分の指定が含まれていないようなの
で，使用時にユーザが決め打ちで指定しなければならないのです．そのため，
-shape オプションを用いると，透明部分を持たない画像に透明部分が現れる
ことがあります．

-geometry オプションはウィンドウの表示位置(ウィンドウ表示モード時)，
または画像の表示位置(ルート表示モード時)を指定します．指定方法は X 
クライアントで一般的に使われている形式です．ただし，指定できるのは
位置のみで，ウィンドウのサイズは指定できません．

操作
----
スペース              : 次の画像を表示
バックスペース        : 前の画像を表示

シフト+スペース, タブ : 10個先の画像
シフト+バックスペース : 10個前の画像

`q'                   : プログラム終了


おまけ
------
random_changer ディレクトリには lfview と各ゲームのアーカイブファイル
を利用する，壁紙チェンジャー(単なるシェルスクリプト)が入っています．使
い方は

  leafbg [sizuku|kizuato|toheart|random]

で，引数に表示したいゲームを指定するとアーカイブ内からランダムに画像が
選択され，表示されます．引数が random の場合はどのゲームの画像にするか
どうかもランダムに選択されます．引数を指定しなかった場合にはコマンドの
簡単な使い方が表示されます．

各ゲームのアーカイブの置き場所と画像リストはそれぞれスクリプト内で指定
しなければなりません．具体的には，leafbg 先頭部分にある変数 LEAFDIR,
LIST_DIR の定義を変更してください．

また，付属の img.* は表示する画像のリストで，これを編集することにより
  -特定の画像を表示させなかったり(リストより削除する)
  -表示の確率を上げたり(リストに複数回記述する)
することができます．

知らないうちに H シーンの画像が背景になっていたりして，あせることがあっ
たりするので要注意 :-)

To Do
-----
  -他の画像のプラグインを作る
  -何かのツールキットを使ってもっとマシなインタフェースを作る(でもやっ
   ぱ面倒．インストールもしにくくなるし ^_^;)．
  -ルートウィンドウ表示の時の背景色の指定(現在は黒固定)．
  -「さおりんといっしょ!!」「初音のないしょ!」の未サポート画像への対応．
  -ディスプレイが 8bpp の時は当然色不足になるので減色を実装したい．

使用条件
--------
このプログラムの配布についてはフリーソフトである限り問題無しとの見解を
リーフさんから頂いております．

よって，このアーカイブ自体は内容を改変しない限り転載は自由です．

プログラムのソースコードおよびその内容は自由に利用して構いませんが，そ
の際生じ得る一切の責任は利用者が負うものとします．実際に配布等を行う場
合には直接リーフさんに問い合わせを行うべきでしょう．

また，当然のことですが，このツールを使用する際には著作権者(リーフ)の権
利を侵害しないように注意してください．作者は著作権者に損害を与えた場合
の責任についても関知しません．このツールを利用した結果生じた損害につい
ても一切関知しません．全てご自身の責任で利用してください．


その他
------
改良パッチやバグレポート・要望は大歓迎です．でも，自分の欲求のままに
(=いきあたりばったりに)作ったプログラムなので，とてもいい加減な作りです．
アーカイブ対応も最初はするつもりじゃなかったし…．

最後になりますが，リーフさんに配布に関する問い合わせをしたところ，フリー
ならばソースコードを含めて配布してよいとの了解を頂けました．ですからファ
ン同士でこの辺りの情報をオープンにして共有できると思いますので，そうい
う仲間を募集します(^_^;

謝辞
----
PS 版「To Heart」への対応部分につきましては，Melody-Yoshi さんの作成さ
れた画像取り出しツールのソースを流用させていただきました．深く感謝いた
します．
(Melody-Yoshi さんのホームページ: http://www.may.sakura.ne.jp/~melody/)

履歴
----
12/29/2000 To Heart の立ち絵表示で落ちるバグへの対処
           -geometry オプションに対応 (Thanks to ZIDNEY さん)
 8/12/2000 「猪名川でいこう!!」の一部画像に対応
 1/30/2000 Playstation 版「To Heart」に暫定対応
          (Special thanks to Melody-Yoshi さん!)
 6/05/1999 「こみっくパーティー」に対応
           LZ77 の展開部分の整理
           *.grp のパレットの解釈をたぶん正解に(Thanks to 木坂さん)
 5/07/1999 「こみっくパーティー(OP デモ)」に対応
           XImage の作り方を修正(Thanks to もなかさん)
 9/15/1998 *.grp の形式の解釈をたぶん正解に & *.gad に対応
           (Thanks to 木坂さん)
           「さおりん」のアーカイブを読む途中に落ちるバグの修正
           透明色の扱いが変なため，ゴミが出るバグの修正
 6/17/1998 バージョン 1.1beta．「White Album」に暫定対応．
 4/08/1998 (密かに画像展開部分を共有ライブラリに追い出していたため，
            Linux 以外で動かなくなっていたのですが ^_^;;) FreeBSD,
            OpenBSD, NEC EWS に対応．
           (Thanks to もなかさん，野萱さん)
 3/26/1998 PseudoColor に対応．
 3/25/1998 色が allocate できないときに落ちる不具合への対処
           (Thanks to もなかさん)
 3/13/1998 「初音のないしょ」の一部対応
 3/10/1998 shape extension に対応．
 3/09/1998 24/32 bpp で色がおかしくなる不具合への対処．
           (Thanks to 黒沢さん)
10/29/1997 バージョン 1.0 を公開
